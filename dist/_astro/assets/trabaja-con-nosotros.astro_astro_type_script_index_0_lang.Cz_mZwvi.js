import y from"./index.DURTWwV8.js";import{v as p,E as n}from"./emailjs.C5prusPA.js";document.addEventListener("DOMContentLoaded",function(){const i=document.getElementById("postulacionForm");i&&i.addEventListener("submit",async function(e){e.preventDefault();const t=i.querySelector(".submit-btn"),r=t.innerHTML;t.innerHTML='<span class="btn-text">Enviando...</span><span class="btn-icon">⏳</span>',t.disabled=!0;try{const s={nombre:i.querySelector('[name="nombre"]').value,email:i.querySelector('[name="email"]').value,telefono:i.querySelector('[name="telefono"]').value||"No proporcionado",ciudad:i.querySelector('[name="ciudad"]').value,especialidad:i.querySelector('[name="especialidad"]').value,experiencia:i.querySelector('[name="experiencia"]').value,motivacion:i.querySelector('[name="motivacion"]').value,aportes:i.querySelector('[name="aportes"]').value,carta:i.querySelector('[name="carta"]').value||"Sin carta de presentación",disponibilidad:i.querySelector('[name="disponibilidad"]').checked?"Sí":"No",time:new Date().toLocaleString("es-CL",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})};if(!p())throw new Error("Configuración de EmailJS incompleta");if((await y.send(n.SERVICE_ID,n.TEMPLATE_ID_TRABAJA,s,n.PUBLIC_KEY)).status===200)alert("¡Gracias por tu postulación! Hemos recibido tu información y nos pondremos en contacto contigo pronto."),i.reset(),i.querySelectorAll("input, select, textarea").forEach(h=>{h.style.borderColor="rgba(202, 1, 1, 0.1)"});else throw new Error("Error en el envío")}catch(s){console.error("Error al enviar el formulario:",s),alert("Hubo un error al enviar tu postulación. Por favor, intenta nuevamente.")}finally{t.innerHTML=r,t.disabled=!1}});const c=i.querySelectorAll("[required]");function u(e){return/^[a-zA-ZÀ-ÿ\u00f1\u00d1\s]+$/.test(e.trim())&&e.trim().length>=2}function m(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e.trim())}function f(e){return e.trim()?/^\+?56\s?[9876]\s?\d{4}\s?\d{4}$/.test(e.trim()):!0}function v(e){if(!e)return!1;if(e.type!=="application/pdf")return{valid:!1,message:"Solo se permiten archivos PDF"};const t=5*1024*1024;return e.size>t?{valid:!1,message:"El archivo no puede superar los 5MB"}:{valid:!0,message:"Archivo válido"}}const o=i.querySelector('[name="nombre"]'),l=i.querySelector('[name="email"]'),a=i.querySelector('[name="telefono"]'),d=i.querySelector('[name="cv"]');o&&(o.addEventListener("blur",function(){u(this.value)?(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity("")):(this.style.borderColor="#E30613",this.setCustomValidity("El nombre solo puede contener letras y espacios, mínimo 2 caracteres"))}),o.addEventListener("input",function(){this.value=this.value.replace(/[0-9]/g,"")})),l&&l.addEventListener("blur",function(){m(this.value)?(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity("")):(this.style.borderColor="#E30613",this.setCustomValidity("Ingresa un correo electrónico válido"))}),a&&(a.addEventListener("blur",function(){this.value&&!f(this.value)?(this.style.borderColor="#E30613",this.setCustomValidity("Formato válido: +56 9 1234 5678")):(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity(""))}),a.addEventListener("input",function(){let e=this.value.replace(/\D/g,"");if(e.startsWith("56")?e="+56 "+e.substring(2):(e.startsWith("9")||e.startsWith("8")||e.startsWith("7")||e.startsWith("6"))&&(e="+56 "+e),e.length>4){const t=e.match(/(\+56)\s?(\d{1})\s?(\d{0,4})\s?(\d{0,4})/);t&&(e=t[1]+" "+t[2],t[3]&&(e+=" "+t[3]),t[4]&&(e+=" "+t[4]))}this.value=e})),d&&d.addEventListener("change",function(){const e=this.files[0],t=v(e);let r=this.parentNode.querySelector(".file-validation-message");r||(r=document.createElement("div"),r.className="file-validation-message",r.style.cssText="font-size: 0.9rem; margin-top: 0.5rem; padding: 0.5rem; border-radius: 4px;",this.parentNode.appendChild(r)),t.valid?(this.style.borderColor="#10b981",this.setCustomValidity(""),r.textContent=`✓ ${t.message} (${(e.size/1024/1024).toFixed(2)} MB)`,r.style.backgroundColor="#d1fae5",r.style.color="#065f46",r.style.border="1px solid #a7f3d0"):(this.style.borderColor="#E30613",this.setCustomValidity(t.message),r.textContent=t.message,r.style.backgroundColor="#fee2e2",r.style.color="#dc2626",r.style.border="1px solid #fecaca")}),c.forEach(e=>{!e.name||["nombre","email","telefono","cv"].includes(e.name)||e.addEventListener("blur",function(){this.value.trim()?(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity("")):(this.style.borderColor="#E30613",this.setCustomValidity("Este campo es obligatorio"))})})});
