import h from"./index.DURTWwV8.js";import{v,E as s}from"./emailjs.C5prusPA.js";document.addEventListener("DOMContentLoaded",function(){const r=document.getElementById("contactForm");r&&r.addEventListener("submit",async function(e){e.preventDefault();const t=r.querySelector(".submit-btn"),d=t.innerHTML;t.innerHTML='<span class="btn-text">Enviando...</span><span class="btn-icon">⏳</span>',t.disabled=!0;try{const n={nombre:r.querySelector('[name="nombre"]').value,email:r.querySelector('[name="email"]').value,telefono:r.querySelector('[name="telefono"]').value,servicio:r.querySelector('[name="servicio"]').value,status:r.querySelector('[name="status"]:checked')?.value||"No especificado",mensaje:r.querySelector('[name="mensaje"]').value||"Sin comentarios adicionales",time:new Date().toLocaleString("es-CL",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})};if(!v())throw new Error("Configuración de EmailJS incompleta");if((await h.send(s.SERVICE_ID,s.TEMPLATE_ID_SERVICIOS,n,s.PUBLIC_KEY)).status===200)alert("¡Gracias por tu consulta! Nos pondremos en contacto contigo en menos de 24 horas."),r.reset(),r.querySelectorAll("input, select, textarea").forEach(f=>{f.style.borderColor="rgba(202, 1, 1, 0.1)"});else throw new Error("Error en el envío")}catch(n){console.error("Error al enviar el formulario:",n),alert("Hubo un error al enviar el formulario. Por favor, intenta nuevamente.")}finally{t.innerHTML=d,t.disabled=!1}});const l=r.querySelectorAll("[required]");function u(e){return/^[a-zA-ZÀ-ÿ\u00f1\u00d1\s]+$/.test(e.trim())&&e.trim().length>=2}function c(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e.trim())}function m(e){return/^\+?56\s?[9876]\s?\d{4}\s?\d{4}$/.test(e.trim())}const o=r.querySelector('[name="nombre"]'),a=r.querySelector('[name="email"]'),i=r.querySelector('[name="telefono"]');o&&(o.addEventListener("blur",function(){u(this.value)?(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity("")):(this.style.borderColor="#E30613",this.setCustomValidity("El nombre solo puede contener letras y espacios, mínimo 2 caracteres"))}),o.addEventListener("input",function(){this.value=this.value.replace(/[0-9]/g,"")})),a&&a.addEventListener("blur",function(){c(this.value)?(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity("")):(this.style.borderColor="#E30613",this.setCustomValidity("Ingresa un correo electrónico válido"))}),i&&(i.addEventListener("blur",function(){m(this.value)?(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity("")):(this.style.borderColor="#E30613",this.setCustomValidity("Formato válido: +56 9 1234 5678"))}),i.addEventListener("input",function(){let e=this.value.replace(/\D/g,"");if(e.startsWith("56")?e="+56 "+e.substring(2):(e.startsWith("9")||e.startsWith("8")||e.startsWith("7")||e.startsWith("6"))&&(e="+56 "+e),e.length>4){const t=e.match(/(\+56)\s?(\d{1})\s?(\d{0,4})\s?(\d{0,4})/);t&&(e=t[1]+" "+t[2],t[3]&&(e+=" "+t[3]),t[4]&&(e+=" "+t[4]))}this.value=e})),l.forEach(e=>{!e.name||["nombre","email","telefono"].includes(e.name)||e.addEventListener("blur",function(){this.value.trim()?(this.style.borderColor="rgba(202, 1, 1, 0.1)",this.setCustomValidity("")):(this.style.borderColor="#E30613",this.setCustomValidity("Este campo es obligatorio"))})})});
